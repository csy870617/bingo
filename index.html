<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>BINGO PRO: SONIC & BALANCE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Noto+Sans+KR:wght@300;700&display=swap" rel="stylesheet">
    <style>
        ::-webkit-scrollbar { display: none; }
        body { 
            -ms-overflow-style: none; scrollbar-width: none; 
            font-family: 'Noto Sans KR', sans-serif; 
            background: radial-gradient(circle at center, #1e293b, #0f172a); 
            color: #f8fafc; overflow-x: hidden;
            overscroll-behavior: none;
        }

        .font-game { font-family: 'Orbitron', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .tab-active { color: #3b82f6 !important; text-shadow: 0 0 10px rgba(59, 130, 246, 0.8); }
        .tab-line { height: 2px; width: 0; background: #3b82f6; transition: all 0.3s ease; margin: 0 auto; box-shadow: 0 0 10px #3b82f6; }
        .active-line { width: 100%; }

        /* ë¹™ê³ íŒ ë ˆì´ì•„ì›ƒ ë³´ì • */
        .bingo-cell { transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); background: rgba(255,255,255,0.03); }
        .bingo-cell.marked { background: linear-gradient(135deg, #2563eb, #7c3aed); border-color: #60a5fa; transform: scale(0.92) rotate(1deg); color: white; box-shadow: 0 0 15px rgba(124, 58, 237, 0.5); }
        
        @keyframes bingo-win-glow { 0%, 100% { box-shadow: 0 0 20px #fbbf24; transform: scale(0.96); } 50% { box-shadow: 0 0 40px #fff7ed; transform: scale(1.0); } }
        .win-cell { background: linear-gradient(135deg, #fbbf24, #f59e0b) !important; animation: bingo-win-glow 0.8s infinite; z-index: 20; color: #451a03 !important; border: 2px solid #fff !important; }

        .rolling { animation: slot-scroll 0.1s infinite alternate; }
        @keyframes slot-scroll { from { transform: translateY(-3px); } to { transform: translateY(3px); } }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <nav class="fixed top-0 w-full z-50 bg-black/40 backdrop-blur-xl border-b border-white/10 h-16">
        <div class="flex justify-center items-center max-w-lg mx-auto h-full px-4">
            <button onclick="switchView('player')" class="flex-1 text-center py-2 transition group">
                <span id="tab-player-text" class="font-game font-bold text-sm tracking-widest tab-active uppercase">Player</span>
                <div id="tab-player-line" class="tab-line active-line"></div>
            </button>
            <button onclick="switchView('host')" class="flex-1 text-center py-2 transition group">
                <span id="tab-host-text" class="font-game font-bold text-sm tracking-widest text-gray-400 uppercase">Host</span>
                <div id="tab-host-line" class="tab-line"></div>
            </button>
        </div>
    </nav>

    <main id="player-view" class="pt-24 pb-12 px-6 flex flex-col items-center">
        <div class="w-full max-w-2xl">
            <div class="flex justify-between items-center mb-10 w-full">
                <h1 class="text-7xl md:text-9xl font-game font-black italic text-blue-500 tracking-tighter uppercase leading-none select-none">Bingo</h1>
                <div class="flex gap-3">
                    <button onclick="toggleManual(true)" class="p-3.5 glass rounded-2xl hover:bg-white/10 transition active:scale-90">
                        <svg class="w-6 h-6 text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </button>
                    <button onclick="confirmReset()" class="p-3.5 glass rounded-2xl hover:bg-blue-500/20 transition group active:scale-90">
                        <svg class="w-6 h-6 text-blue-400 group-hover:rotate-180 transition-transform duration-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                    </button>
                </div>
            </div>

            <div class="flex justify-start mb-6">
                <div id="bingo-counter" class="py-2.5 px-6 glass rounded-full border border-blue-500/30 flex items-center gap-4">
                    <span class="text-blue-300 font-game font-bold text-xs tracking-widest uppercase">Bingo Lines</span>
                    <span id="line-count" class="text-white font-game font-black text-3xl leading-none">0</span>
                </div>
            </div>

            <div class="glass p-5 md:p-10 rounded-[3.5rem] shadow-2xl border border-white/10 w-full">
                <div class="grid grid-cols-5 gap-3 md:gap-5">
                    <div class="flex items-center justify-center font-game font-black text-3xl md:text-6xl text-red-500 pb-2">B</div>
                    <div class="flex items-center justify-center font-game font-black text-3xl md:text-6xl text-orange-400 pb-2">I</div>
                    <div class="flex items-center justify-center font-game font-black text-3xl md:text-6xl text-emerald-400 pb-2">N</div>
                    <div class="flex items-center justify-center font-game font-black text-3xl md:text-6xl text-blue-400 pb-2">G</div>
                    <div class="flex items-center justify-center font-game font-black text-3xl md:text-6xl text-purple-500 pb-2">O</div>
                    <div id="board-grid" class="contents"></div>
                </div>
            </div>
        </div>
    </main>

    <main id="host-view" class="hidden pt-24 pb-12 px-6 flex flex-col items-center">
        <div class="w-full max-w-xl">
            <div class="glass rounded-[4rem] p-12 md:p-16 text-center border-t border-white/10 shadow-2xl mb-10 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-purple-400 to-transparent"></div>
                <div class="flex justify-between items-center mb-12">
                    <div class="w-6"></div>
                    <h2 class="text-slate-400 font-game text-[10px] tracking-[0.5em] uppercase">Master Controller</h2>
                    <button onclick="resetHost()" class="p-2 glass rounded-xl hover:bg-purple-500/20 transition group active:scale-90"><svg class="w-5 h-5 text-purple-400 group-hover:rotate-180 transition-transform duration-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg></button>
                </div>
                
                <div class="flex justify-center items-center gap-6 mb-12">
                    <div id="h-letter" class="w-24 h-36 md:w-32 md:h-48 glass flex items-center justify-center text-6xl md:text-8xl font-game font-black rounded-3xl text-white leading-none shadow-inner">-</div>
                    <div id="h-number" class="w-40 h-36 md:w-56 md:h-48 glass flex items-center justify-center border border-blue-500/40 text-blue-400 text-8xl md:text-[10rem] font-game font-black rounded-3xl leading-none shadow-2xl">?</div>
                </div>

                <button id="draw-btn" onclick="runHostDraw()" class="group relative w-full py-6 md:py-8 rounded-3xl bg-blue-600 font-game font-black text-xl md:text-2xl text-white uppercase hover:bg-blue-500 shadow-2xl active:scale-95 transition overflow-hidden">
                    Generate Next
                </button>
            </div>
            <div class="w-full px-2">
                <div class="flex justify-between items-center mb-6 text-slate-500 font-game text-[10px] tracking-widest uppercase border-b border-white/5 pb-2">
                    <h3>Draw History</h3><span><span id="history-count" class="text-blue-400">0</span> / 60</span>
                </div>
                <div id="h-history" class="flex flex-wrap gap-2.5"></div>
            </div>
        </div>
    </main>

    <div id="manual-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center p-6 bg-black/80 backdrop-blur-md">
        <div class="glass max-w-sm w-full p-10 rounded-[3rem] border border-white/20 shadow-2xl text-center">
            <h3 class="text-2xl font-black text-blue-400 mb-8 font-game italic uppercase tracking-tighter">Instruction</h3>
            <ul class="space-y-6 text-slate-300 text-sm text-left">
                <li class="flex gap-5"><span class="text-blue-500 font-black font-game text-xl">01</span><span class="pt-0.5">B(1-12), I(13-24)... ì •í•´ì§„ ìˆ«ì ë²”ìœ„ë¡œ íŒì´ êµ¬ì„±ë©ë‹ˆë‹¤.</span></li>
                <li class="flex gap-5"><span class="text-blue-500 font-black font-game text-xl">02</span><span class="pt-0.5">ì‚¬íšŒìê°€ ë²ˆí˜¸ë¥¼ ë¶€ë¥´ë©´ í•´ë‹¹ ì¹¸ì„ í„°ì¹˜í•´ ì²´í¬í•˜ì„¸ìš”.</span></li>
                <li class="flex gap-5"><span class="text-blue-500 font-black font-game text-xl">03</span><span class="pt-0.5">ê°€ìš´ë° í™©ê¸ˆ ì‹­ìê°€ëŠ” ì€í˜œì˜ ê³ ì • ì¹¸ì…ë‹ˆë‹¤!</span></li>
            </ul>
            <button onclick="toggleManual(false)" class="w-full mt-10 py-4 bg-blue-600 text-white rounded-2xl font-bold shadow-lg active:scale-95 transition">í™•ì¸</button>
        </div>
    </div>

    <script>
        const RANGES = { 'B': [1,12], 'I': [13,24], 'N': [25,36], 'G': [37,48], 'O': [49,60] };
        let boardState = []; let drawnSet = new Set(); let currentBingoLines = 0;
        
        // ğŸ”Š ì „ë¬¸ì ì¸ ì‚¬ìš´ë“œ í•©ì„± ì—”ì§„
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        // ìˆ«ìê°€ ëŒì•„ê°ˆ ë•Œì˜ ì„¸ë ¨ëœ í‹± ì†Œë¦¬
        function playRollingTick() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(1500, audioCtx.currentTime);
            gain.gain.setValueAtTime(0.015, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.04);
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 0.04);
        }

        // ê²°ê³¼ê°€ í™•ì •ë˜ì—ˆì„ ë•Œì˜ í”„ë¦¬ë¯¸ì—„ ì°¨ì„ë²¨
        function playPremiumChime() {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const now = audioCtx.currentTime;
            [523.25, 659.25, 783.99, 987.77].forEach((freq, i) => {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = 'sine';
                osc.frequency.setValueAtTime(freq, now);
                gain.gain.setValueAtTime(0, now);
                gain.gain.linearRampToValueAtTime(0.06, now + 0.05 + (i * 0.02));
                gain.gain.exponentialRampToValueAtTime(0.001, now + 1.8);
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.start(now + (i * 0.02)); osc.stop(now + 2.0);
            });
        }

        function switchView(view) {
            const isP = view === 'player';
            document.getElementById('player-view').classList.toggle('hidden', !isP);
            document.getElementById('host-view').classList.toggle('hidden', isP);
            document.getElementById('tab-player-text').className = isP ? 'font-game font-bold text-sm tracking-widest tab-active uppercase' : 'font-game font-bold text-sm tracking-widest text-gray-400 uppercase';
            document.getElementById('tab-player-line').classList.toggle('active-line', isP);
            document.getElementById('tab-host-text').className = !isP ? 'font-game font-bold text-sm tracking-widest tab-active uppercase' : 'font-game font-bold text-sm tracking-widest text-gray-400 uppercase';
            document.getElementById('tab-host-line').classList.toggle('active-line', !isP);
        }

        function createBoard() {
            const grid = document.getElementById('board-grid'); grid.innerHTML = ''; boardState = []; currentBingoLines = 0;
            document.getElementById('line-count').innerText = "0";
            const colData = {};
            ['B','I','N','G','O'].forEach(l => {
                colData[l] = Array.from({length: 12}, (_, i) => i + RANGES[l][0]).sort(() => Math.random() - 0.5).slice(0, 5);
            });
            for (let r = 0; r < 5; r++) {
                boardState[r] = [];
                ['B','I','N','G','O'].forEach((l, c) => {
                    const cell = document.createElement('div');
                    cell.className = "bingo-cell aspect-square flex items-center justify-center glass rounded-2xl text-2xl md:text-5xl font-game font-black cursor-pointer hover:bg-white/10";
                    if (r === 2 && c === 2) {
                        cell.innerHTML = `<svg class="w-8 h-8 md:w-16 md:h-16 text-yellow-400 drop-shadow-[0_0_12px_rgba(251,191,36,0.9)]" fill="currentColor" viewBox="0 0 24 24"><path d="M11 2h2v7h7v2h-7v11h-2V11H4V9h7V2z"/></svg>`;
                        cell.classList.add('marked'); boardState[r][c] = { marked: true, el: cell };
                    } else {
                        cell.innerText = colData[l][r]; cell.onclick = () => { cell.classList.toggle('marked'); calculateBingo(); };
                        boardState[r][c] = { marked: false, el: cell };
                    }
                    grid.appendChild(cell);
                });
            }
            calculateBingo();
        }

        function toggleManual(show) { document.getElementById('manual-modal').classList.toggle('hidden', !show); }
        function confirmReset() { if(confirm("ë¹™ê³ íŒì„ ìƒˆë¡œ ë§Œë“œì‹œê² ìŠµë‹ˆê¹Œ?")) createBoard(); }

        function calculateBingo() {
            let lines = 0; let winEls = new Set();
            const getMarked = (r, c) => boardState[r][c].el.classList.contains('marked');
            for(let i=0; i<5; i++) {
                if([0,1,2,3,4].every(c => getMarked(i, c))) { lines++; [0,1,2,3,4].forEach(c => winEls.add(boardState[i][c].el)); }
                if([0,1,2,3,4].every(r => getMarked(r, i))) { lines++; [0,1,2,3,4].forEach(r => winEls.add(boardState[r][i].el)); }
            }
            if([0,1,2,3,4].every(i => getMarked(i, i))) { lines++; [0,1,2,3,4].forEach(i => winEls.add(boardState[i][i].el)); }
            if([0,1,2,3,4].every(i => getMarked(i, 4-i))) { lines++; [0,1,2,3,4].forEach(i => winEls.add(boardState[i][4-i].el)); }
            document.querySelectorAll('.bingo-cell').forEach(el => el.classList.remove('win-cell'));
            winEls.forEach(el => el.classList.add('win-cell'));
            if (lines > currentBingoLines) { confetti({ particleCount: 150, spread: 70, origin: { y: 0.7 } }); }
            currentBingoLines = lines; document.getElementById('line-count').innerText = lines;
        }

        function resetHost() {
            if(confirm("ëª¨ë“  ì¶”ì²¨ ê¸°ë¡ì„ ì´ˆê¸°í™”í• ê¹Œìš”?")) {
                drawnSet.clear(); document.getElementById('h-letter').innerText = "-"; document.getElementById('h-number').innerText = "?";
                document.getElementById('h-history').innerHTML = ""; document.getElementById('history-count').innerText = "0";
            }
        }

        function runHostDraw() {
            if(drawnSet.size >= 60) return alert("60ê°œ ë²ˆí˜¸ê°€ ëª¨ë‘ ì†Œì§„ë˜ì—ˆìŠµë‹ˆë‹¤.");
            const btn = document.getElementById('draw-btn'); btn.disabled = true;
            const lEl = document.getElementById('h-letter'); const nEl = document.getElementById('h-number');
            lEl.classList.add('rolling'); nEl.classList.add('rolling');
            let cycle = 0;
            const timer = setInterval(() => {
                lEl.innerText = ['B','I','N','G','O'][Math.floor(Math.random()*5)];
                nEl.innerText = Math.floor(Math.random()*60)+1;
                playRollingTick(); // ìˆ«ìê°€ ëŒì•„ê°€ëŠ” ë™ì•ˆ ì¬ìƒë  í‹± ì†Œë¦¬
                if(++cycle > 20) {
                    clearInterval(timer); lEl.classList.remove('rolling'); nEl.classList.remove('rolling');
                    let key, num; do {
                        key = ['B','I','N','G','O'][Math.floor(Math.random()*5)];
                        num = Math.floor(Math.random()*12) + RANGES[key][0];
                    } while(drawnSet.has(`${key}-${num}`));
                    drawnSet.add(`${key}-${num}`); lEl.innerText = key; nEl.innerText = num; btn.disabled = false;
                    playPremiumChime(); // ê²°ê³¼ê°€ ë‚˜ì™”ì„ ë•Œì˜ ì°¨ì„ë²¨
                    const tag = document.createElement('div');
                    tag.className = "px-4 py-2 glass border border-blue-500/30 text-blue-300 text-sm rounded-xl font-game shadow-lg";
                    tag.innerText = `${key}-${num}`; document.getElementById('h-history').prepend(tag);
                    document.getElementById('history-count').innerText = drawnSet.size;
                }
            }, 75);
        }

        createBoard();
    </script>
</body>
</html>